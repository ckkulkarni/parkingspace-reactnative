{"version":3,"names":["mock","useNavigation","jest","fn","calculateChargesMock","describe","mockMarkSpaceAsUnoccupied","mockRoute","params","details","reg","time","space","markSpaceAsUnoccupied","it","Date","now","toISOString","route","render","getByTestId","timeSpentElement","console","log","props","children","expect","toHaveTextContent","parkingChargeElement","global","fetch","Promise","resolve","ok","waitFor","fireEvent","press","toHaveBeenCalledTimes","toHaveBeenCalledWith","goBack","spaces","goBackButton","toHaveBeenCalled"],"sources":["PaymentScreen.test.tsx"],"sourcesContent":["import React from 'react';\r\nimport PaymentScreen from '../PaymentScreen';\r\nimport {render, waitFor, fireEvent} from '@testing-library/react-native';\r\nimport '@testing-library/jest-native/extend-expect';\r\nimport {NativeStackNavigationProp} from '@react-navigation/native-stack';\r\nimport {NavigationContainer, useNavigation} from '@react-navigation/native';\r\ndeclare var global: any;\r\njest.mock('@react-navigation/native', () => ({\r\n  useNavigation: jest.fn(),\r\n}));\r\n\r\nconst calculateChargesMock = jest.fn();\r\ndescribe('Payment Screen/Deregister Parking', () => {\r\n  const mockMarkSpaceAsUnoccupied = jest.fn();\r\n  const mockRoute = {\r\n    params: {\r\n      details: {\r\n        reg: 'ABC123',\r\n        time: '21-02-2023',\r\n      },\r\n      space: 1,\r\n      markSpaceAsUnoccupied: mockMarkSpaceAsUnoccupied,\r\n    },\r\n  };\r\n  it('Displays the time spent', () => {\r\n    const details = {\r\n      reg: 'ABC123',\r\n      time: new Date(Date.now() - 60 * 60 * 1000).toISOString(),\r\n    };\r\n    const route = {params: {details}};\r\n    const {getByTestId} = render(<PaymentScreen route={route} />);\r\n    const timeSpentElement = getByTestId('deregester-time-spent');\r\n    console.log('timeSpentElement:', timeSpentElement.props.children[1]);\r\n    expect(timeSpentElement).toHaveTextContent('Time Spent: 1 hours 0 minutes');\r\n  });\r\n  it('Shows parking charge', () => {\r\n    const details = {\r\n      reg: 'ABC123',\r\n      time: new Date(Date.now() - 60 * 60 * 1000).toISOString(),\r\n    };\r\n    const route = {params: {details}};\r\n    const {getByTestId} = render(<PaymentScreen route={route} />);\r\n    const parkingChargeElement = getByTestId('deregester-charge');\r\n    expect(parkingChargeElement).toHaveTextContent('Parking Charges: $10');\r\n  });\r\n  it('calls markSpaceAsUnoccupied and navigates back to previous screen', async () => {\r\n    global.fetch = jest.fn(() =>\r\n      Promise.resolve({\r\n        ok: true,\r\n      }),\r\n    );\r\n    const {getByTestId} = render(<PaymentScreen route={mockRoute} />);\r\n    await waitFor(() => getByTestId('deregester-payment-button'));\r\n    fireEvent.press(getByTestId('deregester-payment-button'));\r\n    await waitFor(() =>\r\n      expect(mockMarkSpaceAsUnoccupied).toHaveBeenCalledTimes(1),\r\n    );\r\n    expect(mockMarkSpaceAsUnoccupied).toHaveBeenCalledWith(1);\r\n  });\r\n  it('should navigate to the previous screen on press of Go Back button', () => {\r\n    const goBack = jest.fn();\r\n    const route = {\r\n      params: {\r\n        spaces: [],\r\n        space: 1,\r\n        details: {reg: 'ABC', time: '22-02-2023'},\r\n        markSpaceAsUnoccupied: jest.fn(),\r\n      },\r\n    };\r\n    const {getByTestId} = render(<PaymentScreen route={route} />);\r\n    const goBackButton = getByTestId('deregester-back');\r\n    fireEvent.press(goBackButton);\r\n    expect(goBack).toHaveBeenCalled();\r\n  });\r\n});\r\n"],"mappings":"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"}