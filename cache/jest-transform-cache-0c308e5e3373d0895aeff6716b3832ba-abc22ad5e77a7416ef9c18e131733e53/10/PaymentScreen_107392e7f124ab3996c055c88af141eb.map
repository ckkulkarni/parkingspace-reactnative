{"version":3,"names":["PaymentScreen","route","navigation","useNavigation","params","spaces","space","details","markSpaceAsUnoccupied","useState","parkingCharge","setCharges","timeSpent","setTimeSpent","useEffect","calculateCharges","timeDiff","Date","getTime","parse","time","hours","Math","floor","minutes","abs","ceil","twoHourCharge","extra","updateTimeSpent","timeSpentString","handlePayment","registration","reg","charge","resultSet","fetch","method","headers","body","JSON","stringify","ok","Alert","alert","goBack","error","console","log","styles","container","buttonStyle2","textStyle","buttonStyle1","StyleSheet","create","flex","alignItems","justifyContent","borderWidth","borderColor","borderRadius","backgroundColor","padding","color","paddingTop","paddingBottom","width","borderBottomColor","borderBottomWidth"],"sources":["PaymentScreen.tsx"],"sourcesContent":["import axios from 'axios';\r\nimport React, {useState, useEffect} from 'react';\r\nimport {View, Text, StyleSheet, Alert, Button} from 'react-native';\r\nimport {useNavigation} from '@react-navigation/native';\r\nimport {NativeStackNavigationProp} from '@react-navigation/native-stack';\r\n\r\nexport default function PaymentScreen({route}: any) {\r\n  const navigation = useNavigation<NativeStackNavigationProp<any>>();\r\n  const {spaces, space, details, markSpaceAsUnoccupied} = route.params;\r\n  const [parkingCharge, setCharges] = useState<number>(0);\r\n  const [timeSpent, setTimeSpent] = useState<string>('0 hours 0 minutes');\r\n\r\n  useEffect(() => {\r\n    calculateCharges();\r\n  }, [details]);\r\n  function calculateCharges() {\r\n    const timeDiff = new Date().getTime() - Date.parse(details.time);\r\n    const hours = Math.floor(timeDiff / (1000 * 60 * 60));\r\n    const minutes = Math.abs(\r\n      Math.abs(Math.ceil((timeDiff % (1000 * 3600)) / (1000 * 60))),\r\n    );\r\n    const twoHourCharge = 10;\r\n    let extra = 0;\r\n    if (hours > 2) {\r\n      extra = (hours - 1) * 10;\r\n    }\r\n    setCharges(twoHourCharge + extra);\r\n    updateTimeSpent(hours, minutes);\r\n  }\r\n  function updateTimeSpent(hours: number, minutes: number) {\r\n    if (minutes > 60) {\r\n      hours += Math.floor(minutes / 60);\r\n      minutes = minutes % 60;\r\n    }\r\n    if (minutes > 0) {\r\n      minutes -= 1;\r\n    }\r\n    const timeSpentString = `${hours} hours ${minutes} minutes`;\r\n    setTimeSpent(timeSpentString);\r\n  }\r\n\r\n  async function handlePayment() {\r\n    const registration = details.reg;\r\n    const charge = parkingCharge;\r\n    try {\r\n      const resultSet = await fetch(`https://httpstat.us/200`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          'car-registration': registration,\r\n          charge: charge,\r\n        }),\r\n      });\r\n      if (resultSet.ok) {\r\n        Alert.alert(`Payment Sucessful`);\r\n        markSpaceAsUnoccupied(space);\r\n        navigation.goBack();\r\n      } else {\r\n        Alert.alert('Payment Failed');\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n  return (\r\n    <View style={styles.container}>\r\n      {details && (\r\n        <View>\r\n          <View style={styles.buttonStyle2}>\r\n            <Button\r\n              color=\"#0551B4\"\r\n              title=\"Go Back\"\r\n              onPress={() => {\r\n                navigation.goBack();\r\n              }}\r\n              testID=\"deregester-back\"\r\n            />\r\n          </View>\r\n          <View style={styles.details}>\r\n            <Text style={styles.textStyle}>\r\n              Car Registration: {details.reg}\r\n            </Text>\r\n            <Text testID=\"deregester-time-spent\" style={styles.textStyle}>\r\n              Time Spent: {timeSpent}\r\n            </Text>\r\n            <Text testID=\"deregester-charge\">\r\n              Parking Charges: ${parkingCharge}\r\n            </Text>\r\n          </View>\r\n          <View style={styles.buttonStyle1}>\r\n            <Button\r\n              color=\"#0551B4\"\r\n              title=\"Payment Taken\"\r\n              onPress={handlePayment}\r\n              testID=\"deregester-payment-button\"\r\n            />\r\n          </View>\r\n        </View>\r\n      )}\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  details: {\r\n    borderWidth: 2,\r\n    borderColor: '#CBD8F5',\r\n    borderRadius: 20,\r\n    backgroundColor: 'white',\r\n    padding: 20,\r\n    color: 'black',\r\n  },\r\n  buttonStyle1: {\r\n    paddingTop: 10,\r\n  },\r\n  buttonStyle2: {\r\n    paddingBottom: 10,\r\n    width: 100,\r\n  },\r\n  textStyle: {\r\n    borderBottomColor: '#EFF2FB',\r\n    borderBottomWidth: 1.3,\r\n    paddingBottom: 3,\r\n  },\r\n});\r\n"],"mappings":"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"}